<!DOCTYPE html>
<html>
<head>
    <title>Profile - AeroBook</title>
    <style>
        body { background: #e9ebee; margin: 0; font-family: sans-serif; }
        .nav { background: #3b5998; color: white; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; }
        .container { max-width: 600px; margin: 20px auto; padding: 0 10px; }
        .header-box { background: white; border: 1px solid #ddd; border-radius: 4px; overflow: hidden; margin-bottom: 20px; }
        .cover { height: 120px; background: linear-gradient(to right, #4285F4, #34A853); }
        .box { background: white; border: 1px solid #ddd; padding: 15px; border-radius: 4px; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div class="nav">
        <a href="/social.html" style="color:white; text-decoration:none;">â—€ Back to Wall</a>
        <b id="navTitle">Profile</b>
        <div style="width:50px;"></div>
    </div>

    <div class="container">
        <div class="header-box">
            <div class="cover"></div>
            <div style="padding:20px; text-align:center;">
                <h2 id="uName" style="margin:0;"></h2>
                <p id="uBio" style="color:#666;"></p>
            </div>
        </div>

        <div id="editBox" class="box" style="display:none;">
            <h4>Update Bio</h4>
            <form action="/api/update-profile" method="POST">
                <textarea name="bio" id="bioIn" style="width:100%; border:1px solid #ddd; padding:5px;"></textarea>
                <button type="submit" style="background:#42b72a; color:white; border:none; padding:8px 20px; border-radius:4px; margin-top:10px;">Save Changes</button>
            </form>
        </div>

        <div id="posts"></div>
    </div>

    <script>
        const user = new URLSearchParams(window.location.search).get('user');
        fetch(`/api/profile/${user}`).then(r => r.json()).then(data => {
            document.getElementById('uName').innerText = data.user.nickname;
            document.getElementById('uBio').innerText = data.user.bio;
            document.getElementById('navTitle').innerText = data.user.nickname;
            
            if(data.isMe) {
                document.getElementById('editBox').style.display = 'block';
                document.getElementById('bioIn').value = data.user.bio;
            }

            document.getElementById('posts').innerHTML = data.posts.map(p => `
                <div class="box"><b>${p.author}</b><p>${p.content}</p></div>
            `).join('');
        });
    </script>
</body>
</html>
